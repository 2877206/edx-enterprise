{% extends 'enterprise/base.html' %}

{% load staticfiles enterprise %}

{% block extrastyles %}
  <link rel="stylesheet" href="{% static 'enterprise/enterprise_program_enrollment_page.css' %}" />
{% endblock %}

{% block extrahead %}
  <script type="text/javascript" src="{% static 'enterprise/course_modal.js' %}"></script>
  <script type="text/javascript" src="{% static 'enterprise/program_enrollment_landing_page.js' %}"></script>
{% endblock %}

{% block contents %}
  <div class="enterprise-container">
    <div class="row">
      <div class="col-3">
        <img class="enterprise-logo" src="{{ enterprise_customer.branding_configuration.logo.url }}" alt="{{ enterprise_customer.name }}"/>
        <p class="partnered-text">{{ welcome_text }}</p>
        <p class="partnered-text">{% autoescape off %}{{ enterprise_welcome_text }}{% endautoescape %}</p>
      </div>

      <div class="col-7 border-left">
        {% if is_learner_eligible_for_one_click_purchase %}
        <div class="program-detail-container">
          {# Display success, error, warning or info messages #}
          {% alert_messages messages %}

          <h2 class="program-confirmation-title">{{ page_title }}</h2>

          <div class="program-detail">
            <div class="program-title">{{ program_title }}</div>
            <div class="program-org">{{ organization_text }}</div>
            <div class="program-overview">{{ program_overview }}</div>
            <ul class="program-bullet-points">
              {# Common bullet points #}
              <li><span class="bullet-item"><a href="#course-list" class="text-underline">{{ course_count_text }}</a></span></li>

              {# Extra bullet points #}
              {% for bullet_point in item_bullet_points %}
                <li><span class="bullet-item">{{ bullet_point }}</span></li>
              {% endfor %}
            </ul>
            <div class="program-price">
              <strong>{{ purchase_text }}</strong>
              {% if is_discounted %}
                <strong>
                  <span class="original-price"><s>{{ program_price }}</s></span> <span class="final-price">{{ program_discounted_price }}</span>
                </strong><br>
                {% autoescape off %}{{ discount_provider }}{% endautoescape %}
              {% else %}
                <strong>{{ program_price }}</strong>
              {% endif %}
            </div>
          </div>

          <form method="POST">
            <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}" />
            <button class="btn-confirm">{{ confirm_button_text }}</button>
          </form>
        </div>

        <div class="program-metadata-container">

          {# What you'll learn #}
          {% if expected_learning_items|length > 0 %}
            <div id="what-youll-learn" class="program-metadata-item">
              <div class="program-metadata-header">
                <span class="program-metadata-header-text">{{ expected_learning_items_text }}</span>
              </div>
              <ul class="program-bullet-points expandable showContent" data-alwaysshow="{{ expected_learning_items_show_count }}">
                {% for item in expected_learning_items %}
                  <li {% if forloop.counter > expected_learning_items_show_count %}hidden{% endif %}>
                    <span class="bullet-item">{{ item }}</span>
                  </li>
                {% endfor %}
              </ul>
              {% if expected_learning_items|length > expected_learning_items_show_count %}
                <div class="expand-list-link-container">
                  <a href="#what-youll-learn" class="expand-list-link">
                    {% fa_icon 'plus-circle' %}
                    <span class="text-underline">{{ see_more_text }}</span>
                  </a>
                </div>
              {% endif %}
            </div>
          {% endif %}

          {# Real Career Impact #}
          {% if corporate_endorsements|length > 0 %}
            <div id="real-career-impact" class="program-metadata-item">
              <div class="program-metadata-header">
                <span class="program-metadata-header-text">{{ corporate_endorsements_text }}</span>
              </div>
              <div class="endorsement-list-container expandable showContent" data-alwaysshow="{{ corporate_endorsements_show_count }}">
                {% for endorsement in corporate_endorsements %}
                  {# Corporation Image #}
                  <div class="endorsement-container" {% if forloop.counter > corporate_endorsements_show_count %}hidden{% endif %}>
                    {% if endorsement.image %}
                      <img class="endorsement-image" src="{{ endorsement.image.src }}" />
                    {% endif %}
                    {% for individual_endorsement in endorsement.individual_endorsements %}
                      {# Endorsement Quote #}
                      <q class="individual-endorsement-quote">{{ individual_endorsement.quote }}</q>
                      <div class="endorser">
                        {# Endorser Description #}
                        <div class="endorser-description-container">
                          <span class="endorser-description">
                            {% with endorser=individual_endorsement.endorser position=individual_endorsement.endorser.position %}
                              &mdash; {{ endorser.given_name }} {{ endorser.family_name }}, {{ position.title }}, {{ position.organization_name }}
                            {% endwith %}
                          </span>
                        </div>
                      </div>
                    {% endfor %}
                  </div>
                {% endfor %}
              </div>
              {% if corporate_endorsements|length > corporate_endorsements_show_count %}
                <div class="expand-list-link-container">
                  <a href="#real-career-impact" class="expand-list-link">
                    {% fa_icon 'plus-circle' %}
                    <span class="text-underline">{{ see_more_text }}</span>
                  </a>
                </div>
              {% endif %}
            </div>
          {% endif %}

        </div>

        {# Program Summary Box #}
        <div class="program-summary-container">
          <div class="program-summary-header"><strong>{{ summary_header }}</strong></div>
          <table class="program-summary">
            <tbody>

              {# Courses #}
              {% if courses %}
              <tr id="course-list-row">
                <td class="summary-item">{{ course_count_text }}:</td>
                <td class="summary-content" id="course-list">
                  {% for course in courses %}
                    <div class="course-item">
                      {% if course.course_runs.0.is_enrolled %}
                        {% if course.course_runs.0.upgrade_url == None %}
                          <span class="enrolled-and-paid-course"><s>{{ course.title }}</s></span> <strong>({{ enrolled_in_course_and_paid_text }})</strong>
                        {% else %}
                          {{ course.title }}<br>
                          <strong>({{ enrolled_in_course_and_unpaid_text }})</strong>
                        {% endif %}
                      {% else %}
                        {{ course.title|link_to_modal:forloop.counter0 }}
                      {% endif %}
                      <br>{{ course.weeks_to_complete }}
                    </div>
                  {% endfor %}
                </td>
              </tr>
              <tr class="row-separator"><td colspan="2"><div class="table-row-separator"></div></td></tr>
              {% endif %}

              {# Price #}
              {% if program_price %}
              <tr id="price-row">
                <td class="summary-item">{{ price_text }}:</td>
                <td class="summary-content">
                  {{ purchase_text }}
                  {% if is_discounted %}
                    <strong>
                      <span class="original-price"><s>{{ program_price }}</s></span> <span class="final-price">{{ program_discounted_price }}</span>
                    </strong><br>
                    {% autoescape off %}{{ discount_provider }}{% endautoescape %}
                  {% else %}
                    <strong>{{ program_price }}</strong>
                  {% endif %}
                </td>
              </tr>
              <tr class="row-separator"><td colspan="2"><div class="table-row-separator"></div></td></tr>
              {% endif %}

              {# Length #}
              {% if length_info_text %}
              <tr id="length-row">
                <td class="summary-item">{{ length_text }}:</td>
                <td class="summary-content">
                  {{ length_info_text }}
                </td>
              </tr>
              <tr class="row-separator"><td colspan="2"><div class="table-row-separator"></div></td></tr>
              {% endif %}

              {# Effort #}
              {% if effort_info_text %}
              <tr id="effort-row">
                <td class="summary-item">{{ effort_text }}:</td>
                <td class="summary-content">{{ effort_info_text }}</td>
              </tr>
              {% endif %}

            </tbody>
          </table>
        </div>
        {% else %}
          <div class="program-detail-container">
            <h4 class="ineligible-program-text">{{ program_not_eligible_for_one_click_purchase_text }}</h4>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
  {% if is_learner_eligible_for_one_click_purchase %}
    {% for course in courses %}
      {% with index=forloop.counter0 %}
        {% course_modal course %}
      {% endwith %}
    {% endfor %}
  {% endif %}
  <div id="see-more-text" aria-hidden="true" hidden>{{ see_more_text }}</div>
  <div id="see-less-text" aria-hidden="true" hidden>{{ see_less_text }}</div>
{% endblock %}
